<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>HBURN_SECOND_AGE_v33.2</title>
    <link href="https://fonts.googleapis.com/css2?family=DM+Sans:ital,opsz,wght@0,9..40,300;0,9..40,400;0,9..40,600;0,9..40,700;1,9..40,400&family=DM+Serif+Display&family=JetBrains+Mono&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/ethers/6.13.2/ethers.umd.min.js"></script>
    <style>
        :root { 
            --pink: #FF2867; 
            --grey-50: #FAFAF9;
            --grey-200: #E7E5E4;
            --grey-400: #A8A29E;
            --grey-800: #292524;
            --grey-900: #1C1917;
            --grey-950: #0F0F0F;
            --bg: #FAFAF9; /* Iniziato in Light Mode come da Brand Kit */
            --surface: #FFFFFF;
            --text-p: #1C1917;
            --text-s: #57534E;
            --border: #E7E5E4;
        }

        /* Dark Mode Override per l'atmosfera terminale */
        @media (prefers-color-scheme: dark) {
            :root {
                --bg: #0F0F0F;
                --surface: #1C1917;
                --text-p: #FAFAF9;
                --text-s: #A8A29E;
                --border: #292524;
            }
        }

        * { box-sizing: border-box; }
        body, html { 
            margin: 0; padding: 0; height: 100vh; 
            background: var(--bg); color: var(--text-p); 
            font-family: 'DM Sans', sans-serif; overflow: hidden; 
            display: flex; justify-content: center; align-items: center; 
        }

        /* Display Headings */
        h1, .display-text { font-family: 'DM Serif Display', serif; font-weight: 400; }

        .app-shell { 
            width: 1240px; height: 800px; 
            background: var(--surface); 
            border: 1px solid var(--border);
            border-radius: 12px; 
            display: grid; grid-template-columns: 320px 1fr 320px;
            padding: 40px; gap: 30px;
            box-shadow: 0 40px 80px rgba(0,0,0,0.15);
        }

        .column { display: flex; flex-direction: column; gap: 20px; overflow: hidden; }

        /* WIDGETS */
        .widget { 
            background: transparent; 
            border-bottom: 1px solid var(--border); 
            padding: 0 0 20px 0; 
            position: relative; 
        }
        .label { 
            font-size: 11px; color: var(--text-s); 
            text-transform: uppercase; letter-spacing: 0.1em; font-weight: 700; 
        }
        .val { 
            font-family: 'DM Serif Display', serif;
            font-size: 32px; margin-top: 8px; 
            color: var(--text-p);
        }
        .sub-val { font-size: 13px; color: var(--text-s); margin-top: 4px; }

        /* CONSOLE - Polkadot Style */
        #console { 
            flex-grow: 1; background: var(--bg); border-radius: 8px; 
            border: 1px solid var(--border); 
            padding: 24px; font-family: 'JetBrains Mono', monospace; font-size: 11px; 
            color: var(--text-s); overflow-y: auto; line-height: 1.7;
        }
        .log-accent { color: var(--pink); font-weight: 600; }

        /* BUTTONS */
        .btn-primary { 
            background: var(--pink); border: none; color: #fff; padding: 20px; 
            cursor: pointer; font-size: 14px; 
            border-radius: 50px; font-weight: 600; 
            transition: all 0.2s ease;
        }
        .btn-primary:hover { transform: translateY(-2px); filter: brightness(1.1); box-shadow: 0 10px 20px rgba(255, 40, 103, 0.2); }
        .btn-primary:disabled { background: var(--grey-400); cursor: not-allowed; transform: none; box-shadow: none; }
        
        .btn-abort { 
            background: transparent; color: var(--text-s); 
            border: 1px solid var(--border); padding: 15px; 
            border-radius: 50px; cursor: pointer; font-size: 12px; font-weight: 500; 
        }
        .btn-abort:hover { border-color: var(--text-p); color: var(--text-p); }

        /* AUTH OVERLAY */
        #auth { 
            position:fixed; inset:0; background:var(--bg); z-index:1000; 
            display:flex; flex-direction:column; justify-content:center; align-items:center; 
        }
        .auth-card {
            text-align: center; max-width: 400px; width: 100%;
        }
        input[type="password"] { 
            background: var(--surface); border: 1px solid var(--border); 
            border-radius: 8px; color: var(--text-p); 
            width: 100%; padding: 20px; text-align: center; 
            outline: none; font-size: 16px; margin-bottom: 20px;
            font-family: 'DM Sans', sans-serif;
        }
    </style>
</head>
<body>

<div id="auth">
    <div class="auth-card">
        <h1 style="font-size:48px; margin:0 0 10px 0;">Second Age</h1>
        <p style="color:var(--text-s); letter-spacing:3px; text-transform:uppercase; font-size:11px; margin-bottom:40px; font-weight:700;">HBURN v33.2 Industrial Access</p>
        <input type="password" id="inputKey" placeholder="Private Key (0x...)">
        <button onclick="unlock()" class="btn-primary" style="width:100%;">Authenticate</button>
    </div>
</div>

<div class="app-shell" id="mainTerminal" style="display: none;">
    <div class="column">
        <div class="widget">
            <div class="label">Paseo Pulse</div>
            <div id="blockSpeed" class="val" style="color:var(--pink)">0.00s</div>
            <div class="sub-val" id="blockHeight">Network Block #--</div>
        </div>
        <div class="widget">
            <div class="label">Fuel Reserve</div>
            <div id="pasBalance" class="val">0.0000 PAS</div>
            <div class="sub-val">System Status: <span style="color:var(--pink)">Nominal</span></div>
        </div>
        <div class="widget">
            <div class="label">Target Intel</div>
            <div class="sub-val" style="word-break: break-all; font-family: 'JetBrains Mono'; margin-top:10px;">0xf63adbb9ef464443ea1f9eb3e28c0d0ad321b760</div>
        </div>
        
        <div style="margin-top:auto; display:flex; flex-direction:column; gap:12px">
            <button id="injBtn" class="btn-primary" onclick="run()">Initiate Attack</button>
            <button class="btn-abort" onclick="location.reload()">Terminate Session</button>
        </div>
    </div>

    <div class="column">
        <div class="label" style="margin-bottom: 5px;">Decryption Stream</div>
        <div id="console"></div>
    </div>

    <div class="column">
        <div class="widget">
            <div class="label">Total Supply</div>
            <div id="totalSupply" class="val">0.00</div>
            <div class="sub-val">Aggregated Token Metric</div>
        </div>
        <div class="widget">
            <div class="label">Mint Velocity</div>
            <div id="mCount" class="val">0</div>
            <div class="sub-val">Batch injections</div>
        </div>
        <div class="widget">
            <div class="label">Burn Volume</div>
            <div id="bCount" class="val" style="color:var(--pink)">0</div>
            <div class="sub-val">Asset purging</div>
        </div>
        <div class="widget">
            <div class="label">Junk Overflow</div>
            <div id="jCount" class="val" style="font-size: 18px;">0</div>
            <div class="sub-val">Current stress load</div>
        </div>
        
        <div class="widget" style="margin-top:auto; border: none; background: var(--grey-50); padding: 20px; border-radius: 8px;">
            <div class="label" style="color:var(--pink)">Stealth Strikes</div>
            <div id="sCount" class="val" style="font-size: 40px;">0</div>
        </div>
    </div>
</div>

<script>
    // Logica Ethers.js mantenuta intatta, aggiornata per integrazione UI
    let SESSION_KEY = "", localNonce = 0, isRunning = false;
    const ADDR = "0xf63adbb9ef464443ea1f9eb3e28c0d0ad321b760";
    const TARGET = "0x3dd695D734B5DdE6B1955FFE75004c00862fb233";
    const CONFIG = { rpc: "https://testnet-passet-hub-eth-rpc.polkadot.io", addr: ADDR };
    const abi = ["function trigger() public", "function ping(string) public", "function transfer(address, uint256) public returns (bool)", "function totalSupply() view returns (uint256)"];

    function addLog(msg, isAccent = false) {
        const con = document.getElementById('console');
        const d = document.createElement('div');
        const colorClass = isAccent ? 'class="log-accent"' : '';
        d.innerHTML = `<span style="color:var(--grey-400)">[${new Date().toLocaleTimeString()}]</span> <span ${colorClass}>${msg}</span>`;
        con.prepend(d);
        if(con.childNodes.length > 50) con.removeChild(con.lastChild);
    }

    async function unlock() {
        const key = document.getElementById('inputKey').value.trim();
        try {
            const provider = new ethers.JsonRpcProvider(CONFIG.rpc);
            const wallet = new ethers.Wallet(key);
            localNonce = await provider.getTransactionCount(wallet.address);
            SESSION_KEY = key;
            document.getElementById('auth').style.display = 'none';
            document.getElementById('mainTerminal').style.display = 'grid';
            startMonitor();
            addLog("System encrypted session established.", true);
        } catch (e) { alert("Invalid Credentials."); }
    }

    function startMonitor() {
        const provider = new ethers.JsonRpcProvider(CONFIG.rpc);
        const contract = new ethers.Contract(ADDR, abi, provider);
        let lastB = Date.now();
        provider.on("block", async (num) => {
            document.getElementById('blockSpeed').innerText = ((Date.now()-lastB)/1000).toFixed(2) + "s";
            document.getElementById('blockHeight').innerText = "Block #" + num;
            lastB = Date.now();
            contract.totalSupply().then(s => document.getElementById('totalSupply').innerText = parseFloat(ethers.formatEther(s)).toLocaleString());
            provider.getBalance(new ethers.Wallet(SESSION_KEY).address).then(g => document.getElementById('pasBalance').innerText = parseFloat(ethers.formatEther(g)).toFixed(4) + " PAS");
            provider.getTransactionCount(new ethers.Wallet(SESSION_KEY).address).then(n => { if(n > localNonce) localNonce = n; });
        });
    }

    async function run() {
        isRunning = true;
        document.getElementById('injBtn').disabled = true;
        document.getElementById('injBtn').innerText = "Strike Active";
        const provider = new ethers.JsonRpcProvider(CONFIG.rpc);
        const wallet = new ethers.Wallet(SESSION_KEY, provider);
        const contract = new ethers.Contract(ADDR, abi, wallet);
        addLog("PROTOCOL_ENGAGED: Sharding across 8 threads.", true);

        // THREAD 1: MINT
        (async () => {
            while(isRunning) {
                contract.trigger({ gasLimit: 1200000, nonce: localNonce++ })
                    .then(() => { 
                        document.getElementById('mCount').innerText = parseInt(document.getElementById('mCount').innerText) + 150;
                        addLog("MINT: Batch Injected");
                    }).catch(() => localNonce--);
                await new Promise(r => setTimeout(r, 1000));
            }
        })();

        // THREAD 2: BURN
        (async () => {
            while(isRunning) {
                contract.transfer(TARGET, ethers.parseEther("0.1"), { gasLimit: 400000, nonce: localNonce++ })
                    .then(() => { 
                        document.getElementById('bCount').innerText = parseInt(document.getElementById('bCount').innerText) + 150;
                        document.getElementById('sCount').innerText++;
                        addLog("BURN: Asset Purged", true);
                    }).catch(() => localNonce--);
                await new Promise(r => setTimeout(r, 2000));
            }
        })();

        // THREAD 3-10: JUNK SPAM
        for(let i=0; i<8; i++) {
            (async () => {
                while(isRunning) {
                    for(let j=0; j<15; j++) {
                        contract.ping("STRESS_"+Math.random(), { gasLimit: 250000, nonce: localNonce++ })
                            .then(() => document.getElementById('jCount').innerText = (parseInt(document.getElementById('ui-jCount' || 0) + 10000)).toLocaleString())
                            .catch(() => localNonce--);
                    }
                    await new Promise(r => setTimeout(r, 500));
                }
            })();
        }
    }
</script>
</body>
</html>
