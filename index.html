<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <title>BURN_PROTOCOL_V8</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/ethers/6.7.0/ethers.umd.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700&family=Outfit:wght@300;600&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #00ffa3;
            --secondary: #ff3e8d;
            --bg: #050608;
            --panel: rgba(10, 12, 18, 0.9);
        }

        * { box-sizing: border-box; }
        body, html { 
            margin: 0; padding: 0; width: 100%; height: 100%; 
            background: var(--bg); color: #fff; 
            font-family: 'Outfit', sans-serif; overflow: hidden;
        }

        /* SFONDO ANIMATO SPAM & ERRORI */
        #bgCanvas {
            position: fixed; top: 0; left: 0; z-index: 1; opacity: 0.3;
            filter: blur(1px);
        }

        .wrapper {
            position: relative; z-index: 2;
            display: flex; justify-content: center; align-items: center;
            width: 100vw; height: 100vh;
            background: radial-gradient(circle at center, transparent 0%, var(--bg) 90%);
        }

        .main-panel {
            width: 850px; height: 550px;
            background: var(--panel);
            backdrop-filter: blur(40px);
            border: 1px solid rgba(0, 255, 163, 0.2);
            border-radius: 40px;
            display: grid;
            grid-template-columns: 320px 1fr;
            overflow: hidden;
            box-shadow: 0 0 100px rgba(0,0,0,1), 0 0 30px rgba(0, 255, 163, 0.1);
        }

        .controls {
            padding: 40px; border-right: 1px solid rgba(255,255,255,0.05);
            display: flex; flex-direction: column; justify-content: space-between;
            background: rgba(0,0,0,0.2);
        }

        .brand { font-weight: 600; letter-spacing: 3px; color: var(--primary); font-size: 12px; }
        .balance-label { font-size: 10px; color: #666; text-transform: uppercase; margin-top: 40px; }
        .balance-value { font-family: 'JetBrains Mono'; font-size: 38px; font-weight: 700; color: #fff; margin-bottom: 20px; }

        .stat-card { background: rgba(255,255,255,0.02); padding: 15px; border-radius: 20px; border: 1px solid rgba(255,255,255,0.05); margin-bottom: 10px; }
        .stat-card div { font-size: 9px; color: #555; text-transform: uppercase; }
        .stat-card span { font-family: 'JetBrains Mono'; font-size: 22px; font-weight: bold; }

        #btnLaunch {
            background: var(--primary); color: #000; border: none; padding: 22px; 
            border-radius: 20px; font-weight: 800; cursor: pointer;
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275); 
            text-transform: uppercase; letter-spacing: 1px;
        }
        #btnLaunch:hover { transform: scale(1.05); box-shadow: 0 0 20px var(--primary); }
        #btnLaunch.active { background: #1a1d23; color: var(--primary); transform: scale(0.98); cursor: default; box-shadow: none; }

        .feed { padding: 40px; display: flex; flex-direction: column; background: rgba(0,0,0,0.1); }
        #console {
            flex-grow: 1; overflow-y: auto; font-family: 'JetBrains Mono'; font-size: 11px; color: #666;
            mask-image: linear-gradient(to bottom, transparent, black 15%, black 85%, transparent);
        }
        .log-entry { margin-bottom: 12px; padding-left: 15px; border-left: 1px solid #222; animation: fadeIn 0.3s ease; }
        @keyframes fadeIn { from { opacity: 0; transform: translateX(-10px); } to { opacity: 1; transform: translateX(0); } }
        .log-m { color: var(--primary); border-color: var(--primary); }
        .log-b { color: var(--secondary); border-color: var(--secondary); }
    </style>
</head>
<body>

<canvas id="bgCanvas"></canvas>

<div class="wrapper">
    <div class="main-panel">
        <div class="controls">
            <div class="brand">CORE_AUTO_v8.1</div>
            <div>
                <div class="balance-label">Contract Internal Supply</div>
                <div id="balance" class="balance-value">0.00</div>
                <div class="stat-card">
                    <div>Mints Confirmed</div>
                    <span id="mCount">0</span>
                </div>
                <div class="stat-card">
                    <div>Burns Confirmed</div>
                    <span id="bCount" style="color: var(--secondary)">0</span>
                </div>
            </div>
            <button id="btnLaunch">Initiate Loop</button>
        </div>
        <div class="feed">
            <div style="font-size: 10px; color: #333; margin-bottom: 20px; letter-spacing: 2px;">LIVE_STRESS_MONITOR</div>
            <div id="console"></div>
        </div>
    </div>
</div>

<script>
    // --- MATRIX BACKGROUND LOGIC ---
    const canvas = document.getElementById('bgCanvas');
    const ctx = canvas.getContext('2d');
    let width = canvas.width = window.innerWidth;
    let height = canvas.height = window.innerHeight;

    const messages = ["0x01edfe...", "GAS_LIMIT", "MINTING", "BURNING", "SPAM_V8", "NULL", "ERROR", "TX_PENDING", "0x11b5bd..."];
    const columns = Math.floor(width / 25);
    const drops = Array(columns).fill(1);

    function drawMatrix() {
        ctx.fillStyle = "rgba(5, 6, 8, 0.15)";
        ctx.fillRect(0, 0, width, height);
        
        ctx.font = "10px 'JetBrains Mono'";
        
        for (let i = 0; i < drops.length; i++) {
            const text = messages[Math.floor(Math.random() * messages.length)];
            const x = i * 25;
            const y = drops[i] * 15;

            // Colore dinamico: alterna verde e rosso per gli errori
            ctx.fillStyle = Math.random() > 0.9 ? "#ff3e8d" : "#00ffa3";
            ctx.fillText(text, x, y);

            if (y > height && Math.random() > 0.975) drops[i] = 0;
            drops[i]++;
        }
    }
    setInterval(drawMatrix, 50);

    window.addEventListener('resize', () => {
        width = canvas.width = window.innerWidth;
        height = canvas.height = window.innerHeight;
    });

    // --- BLOCKCHAIN LOGIC ---
    const CONFIG = {
        rpc: "https://testnet-passet-hub-eth-rpc.polkadot.io",
        key: "e7b0f8447fb5c168c7f2f33e30ed2377aef70a71546c58e4cc3690e62769df12",
        contract: "0xb4310dc7a7d5624443e3ff6977c4fb7fcb36b967"
    };

    const abi = ["function trigger() public", "function ping(string memory) public", "function balanceOf(address) view returns (uint256)"];
    let m = 0, b = 0;

    const addLog = (msg, cls="") => {
        const c = document.getElementById('console');
        const d = document.createElement('div');
        d.className = `log-entry ${cls}`;
        d.innerHTML = `<span>${new Date().toLocaleTimeString()}</span> > ${msg}`;
        c.prepend(d);
        if(c.childNodes.length > 40) c.removeChild(c.lastChild);
    };

    document.getElementById('btnLaunch').onclick = async function() {
        this.disabled = true; this.classList.add('active'); this.innerText = "System Live";
        
        const provider = new ethers.JsonRpcProvider(CONFIG.rpc);
        const wallet = new ethers.Wallet(CONFIG.key, provider);
        const contract = new ethers.Contract(CONFIG.contract, abi, wallet);

        addLog("DECODING KERNEL... STRESS TEST START.");

        setInterval(async () => {
            try {
                const tx = await contract.trigger({ gasLimit: 300000 });
                addLog("TRIGGER_SENT: BROADCASTING...");
                await tx.wait();
                
                const bal = await contract.balanceOf(CONFIG.contract);
                document.getElementById('balance').innerText = parseFloat(ethers.formatEther(bal)).toFixed(2);
                
                m++; document.getElementById('mCount').innerText = m;
                if(m % 3 === 0) { b++; document.getElementById('bCount').innerText = b; addLog("ACTION: INTERNAL_BURN_COMPLETE", "log-b"); }
            } catch(e) { addLog("NODE_DELAY: RECALIBRATING...", "log-entry"); }
        }, 11000);

        setInterval(async () => {
            try { await contract.ping("SPAM_DETECTOR_OFF", { gasLimit: 120000 }); addLog("JUNK_INJECTED", "log-m"); } catch(e) {}
        }, 16000);
    };
</script>
</body>
</html>
